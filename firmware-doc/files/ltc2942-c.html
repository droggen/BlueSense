<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>ltc2942.c</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0 (Development Release 08-22-2015) -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="ltc2942"></a><a name="Topic185"></a><div class="CTopic TFile LC first">
 <div class="CTitle">ltc2942</div>
 <div class="CBody"><p>LTC2942 functions</p><p>This library interfaces with the LTC2942 gas gauge which allows to measure charge flowing through the battery.</p><p><b>Dependencies</b></p><ul><li><p>I2C library</p></li></ul><p><b>Key functions</b></p><p>This library provides immediate functions which immediately carry out an action, and functions which initiate background reads and return data read after these background reads.</p><p>In order to use background functions, ltc2942_backgroundgetstate must be called at regular intervals, typically from a timer interrupt.</p><p>Prior to using any functions ltc2942_init must be called.</p><p>The key immediate functions are:</p><ul><li><p>ltc2942_init:					Initialise the LTC2942 to default settings.</p></li><li><p>ltc2942_getcharge:			Returns the charge counter in uAh.</p></li><li><p>ltc2942_getchargectr:			Returns the 16-bit accumulated charge counter.</p></li><li><p>ltc2942_setchargectr:			Sets the 16-bit accumulated charge counter.</p></li><li><p>ltc2942_getvoltage:			Returns the voltage on the battery lead in millivolts.</p></li><li><p>ltc2942_gettemperature:		Returns the LTC2942 temperature in decidegrees (1 unit=0.1?celsius).</p></li><li><p>ltc2942_setadc:				Setups the LTC2942 conversion of voltage and temperature and the charge prescaler.</p></li><li><p>ltc2942_setprescaler:			Setups the LTC2942 charge prescaler.</p></li><li><p>ltc2942_printreg:				Prints the LTC2942 register states to a file.</p></li><li><p>ltc2942_getavgpower: 			Computes the average power consumption in mW</p></li></ul><p>The key background functions are:</p><ul><li><p>ltc2942_backgroundgetstate:	Initiates a background read of the LTC2942 charge, voltage and temperature registers.&nbsp; This function can be called from a timer interrupt to perform transparent background read of the battery status</p></li><li><p>ltc2942_last_charge:			Returns the charge counter in uAh.</p></li><li><p>ltc2942_last_chargectr:		Returns the 16-bit accumulated charge counter.</p></li><li><p>ltc2942_last_mV:				Returns the voltage on the battery lead in millivolts.</p></li><li><p>ltc2942_last_mA:				Returns the average current between two background reads in mA.</p></li><li><p>ltc2942_last_mW:				Returns the average power between two background reads in mW.</p></li><li><p>ltc2942_last_temperature:		Returns the LTC2942 temperature in decidegrees (1 unit=0.1?celsius).</p></li><li><p>ltc2942_last_strstatus		Returns a status string describing the battery mV, mA and mW.</p></li></ul><p><b>Usage in interrupts</b></p><p>None of the immediate functions are suitable to be called from interrupts and will result in a crash, with exception of ltc2942_getavgpower.</p><p>The function ltc2942_backgroundgetstate can be called from an interrupt (typically a timer interrupt) to initiate a background read of the data. All the background functions can be called from interrupts.</p><p><b>Recommended usage</b></p><p>Register ltc2942_backgroundgetstate in a periodic timer interrupt (e.g. every 10 seconds) and use the functions ltc2942_last_* in the main application.</p></div>
</div>

<a name="Functions"></a><a name="Topic176"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Functions</div>
</div>

<a name="ltc2942_init"></a><a name="Topic177"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_init</div>
 <div id="NDPrototype177" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> ltc2942_init(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Initialise the LTC2942 to default settings: automatic conversion of voltage and temperature, highest charge resolution, charge counter set at mid-point suitable to measure battery charge or discharge.</p><p>With these settings the maximum charge/discharge that can be measured is 21mAh.</p><div class="CHeading">Note</div><p>no error checking on the I2C interface.</p></div>
</div>

<a name="ltc2942_getchargectr"></a><a name="Topic178"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getchargectr</div>
 <div id="NDPrototype178" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span> ltc2942_getchargectr(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the 16-bit accumulated charge counter.</p><div class="CHeading">Note</div><p>no error checking on the I2C interface.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Charge</td><td class="CDLDefinition"><p>16-bit accumulated charge</p></td></tr></table></div>
</div>

<a name="ltc2942_getcharge"></a><a name="Topic179"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getcharge</div>
 <div id="NDPrototype179" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span> ltc2942_getcharge(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the charge counter in uAh.&nbsp; This function takes into account the prescaler of the LTC2942 and converts the charge counter into uAh.</p><p>The maximum value that this function returns is 5'570'475.</p><div class="CHeading">Note</div><p>no error checking on the I2C interface.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Charge</td><td class="CDLDefinition"><p>Charge in uAh</p></td></tr></table></div>
</div>

<a name="ltc2942_chargectr_to_charge"></a><a name="Topic189"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_chargectr_to_charge</div>
 <div id="NDPrototype189" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span> ltc2942_chargectr_to_charge(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">chargectr,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">prescalerm</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Converts a charge count into a charge in uAh.</p><p>The maximum value that this function returns is 5'570'475.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">chargectr<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>Charge counter</p></td></tr><tr><td class="CDLEntry">prescaler</td><td class="CDLDefinition"><p>Prescaler M (M=2^P) Returns:</p></td></tr><tr><td class="CDLEntry">Charge</td><td class="CDLDefinition"><p>Charge in uAh</p></td></tr></table></div>
</div>

<a name="ltc2942_setchargectr"></a><a name="Topic180"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_setchargectr</div>
 <div id="NDPrototype180" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_setchargectr(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">short</span>&nbsp;</td><td class="PName last">charge</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Sets the 16-bit accumulated charge counter.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">0</td><td class="CDLDefinition"><p>Success</p></td></tr><tr><td class="CDLEntry">nonzero</td><td class="CDLDefinition"><p>Error</p></td></tr></table></div>
</div>

<a name="ltc2942_getvoltage"></a><a name="Topic181"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getvoltage</div>
 <div id="NDPrototype181" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span> ltc2942_getvoltage(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the voltage on the battery lead in millivolts.</p><div class="CHeading">Note</div><p>no error checking on the I2C interface.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Voltage</td><td class="CDLDefinition"><p>Voltage in millivolts</p></td></tr></table></div>
</div>

<a name="ltc2942_gettemperature"></a><a name="Topic196"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_gettemperature</div>
 <div id="NDPrototype196" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">short</span> ltc2942_gettemperature(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the LTC2942 temperature in decidegrees (1 unit=0.1?celsius).</p><div class="CHeading">Note</div><p>no error checking on the I2C interface.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Temperature[dd]</td><td class="CDLDefinition"><p>Temperature in decidegrees (1 unit=0.1?celsius)</p></td></tr></table></div>
</div>

<a name="ltc2942_setadc"></a><a name="Topic183"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_setadc</div>
 <div id="NDPrototype183" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_setadc(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">adc</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Setups the LTC2942 ADC conversion of voltage and temperature between single, automatic or disabled.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">adc<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>2-bits indicating: 11:temperature&amp;voltage conversion every second; 10: single voltage conversion; 01: single temperature conversion; 00: no conversion (sleep).</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">0</td><td class="CDLDefinition"><p>Success</p></td></tr><tr><td class="CDLEntry">nonzero</td><td class="CDLDefinition"><p>Error</p></td></tr></table></div>
</div>

<a name="ltc2942_setprescaler"></a><a name="Topic184"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_setprescaler</div>
 <div id="NDPrototype184" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_setprescaler(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">prescaler</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Setups the LTC2942 charge prescaler.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">prescaler<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>3-bits indicating the prescaler value M between 1 and 128. M = 2^prescaler.</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">0</td><td class="CDLDefinition"><p>Success</p></td></tr><tr><td class="CDLEntry">nonzero</td><td class="CDLDefinition"><p>Error</p></td></tr></table></div>
</div>

<a name="ltc2942_getprescaler"></a><a name="Topic231"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getprescaler</div>
 <div id="NDPrototype231" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_getprescaler(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the 3-bit prescaler P value.&nbsp; The actual prescaler value M is betweeen 1 and 128: M=2^prescaler.</p><p>This function returns a cached version of the prescaler set with ltc2942_setprescaler.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">prescaler</td><td class="CDLDefinition"><p>3-bit prescaler value</p></td></tr></table></div>
</div>

<a name="ltc2942_printreg"></a><a name="Topic186"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_printreg</div>
 <div id="NDPrototype186" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> ltc2942_printreg(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">FILE&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">file</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Prints the LTC2942 register states to a file.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">file<div class="CDLParameterType">FILE*</div></td><td class="CDLDefinition"><p>File on which the registers must be printed</p></td></tr></table><div class="CHeading">Returns</div><p>void</p></div>
</div>

<a name="ltc2942_getavgpower"></a><a name="Topic322"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getavgpower</div>
 <div id="NDPrototype322" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">signed</span> <span class="SHKeyword">short</span> ltc2942_getavgpower(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">c1,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">c2,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">short</span>&nbsp;</td><td class="PName last">voltage,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">ms</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Computes the average power consumption in mW between two readings of the charge done after a time interval ms.&nbsp; This function assumes that the battery voltage is approximately constant between the first and second charge measure.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">c1<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>First charge reading in uAh (at a previous time)</p></td></tr><tr><td class="CDLEntry">c2<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>Second charge reading in uAh (at current time)</p></td></tr><tr><td class="CDLEntry">voltage<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span></div></td><td class="CDLDefinition"><p>Voltage in millivolts</p></td></tr><tr><td class="CDLEntry">ms<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>Time interval between first and second charge readings</p></td></tr></table><div class="CHeading">Returns</div><p>Average power in mW</p></div>
</div>

<a name="ltc2942_getavgpower2"></a><a name="Topic323"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_getavgpower2</div>
 <div id="NDPrototype323" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">signed</span> <span class="SHKeyword">long</span> ltc2942_getavgpower2(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">c1,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">c2,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">short</span>&nbsp;</td><td class="PName last">voltage1,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">short</span>&nbsp;</td><td class="PName last">voltage2,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">long</span>&nbsp;</td><td class="PName last">s</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Computes the average power consumption in uW between two readings of the charge and voltage done after a time interval s.</p><p>This function is designed for long-duration intervals and low power (uW), such as measuring current during off or long-duration sleeps.</p><p>This function assumes the voltage changes linearly between the two measurement points.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">c1<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>First charge reading in uAh (at a previous time)</p></td></tr><tr><td class="CDLEntry">c2<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>Second charge reading in uAh (at current time)</p></td></tr><tr><td class="CDLEntry">voltage1<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span></div></td><td class="CDLDefinition"><p>First voltage reading in millivolts</p></td></tr><tr><td class="CDLEntry">voltage2<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span></div></td><td class="CDLDefinition"><p>Second voltage reading in millivolts</p></td></tr><tr><td class="CDLEntry">s<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span></div></td><td class="CDLDefinition"><p>Time interval between first and second charge readings</p></td></tr></table><div class="CHeading">Returns</div><p>Average power in uW</p></div>
</div>

<a name="ltc2942_backgroundgetstate"></a><a name="Topic233"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_backgroundgetstate</div>
 <div id="NDPrototype233" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_backgroundgetstate(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PName last">char</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Call from user code or a timer interrupt to initiate a background read of the LTC2942 state registers (accumulated charge, voltage, temperature).</p><p>The background read is completed when the callback __ltc2942_trans_read_done is called by the I2C engine.</p><p>The results are available through the ltc2942_last_xxx functions.</p><div class="CHeading">Parameters</div><p>None / not used Returns: Nothing.</p></div>
</div>

<a name="ltc2942_last_updatetime"></a><a name="Topic234"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_updatetime</div>
 <div id="NDPrototype234" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span> ltc2942_last_updatetime(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the time in ms when the last background read occurred.</p><div class="CHeading">Parameters</div><p>None Returns: Time in ms when a background read last occurred.</p></div>
</div>

<a name="ltc2942_last_charge"></a><a name="Topic235"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_charge</div>
 <div id="NDPrototype235" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span> ltc2942_last_charge(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the charge counter in uAh obtained during the last background read.</p><p>This function takes into account the prescaler of the LTC2942 and converts the charge counter into uAh.</p><p>The maximum value that this function returns is 5'570'475.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Charge</td><td class="CDLDefinition"><p>Charge in uAh</p></td></tr></table></div>
</div>

<a name="ltc2942_last_chargectr"></a><a name="Topic236"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_chargectr</div>
 <div id="NDPrototype236" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span> ltc2942_last_chargectr(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the 16-bit accumulated charge counter obtained during the last background read.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Charge</td><td class="CDLDefinition"><p>16-bit accumulated charge</p></td></tr></table></div>
</div>

<a name="ltc2942_last_mV"></a><a name="Topic237"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_mV</div>
 <div id="NDPrototype237" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">short</span> ltc2942_last_mV(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the voltage on the battery lead in millivolts obtained during the last background read.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Voltage</td><td class="CDLDefinition"><p>Voltage in millivolts</p></td></tr></table></div>
</div>

<a name="ltc2942_last_temperature"></a><a name="Topic324"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_temperature</div>
 <div id="NDPrototype324" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">short</span> ltc2942_last_temperature(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the LTC2942 temperature in decidegrees (1 unit=0.1?celsius) obtained during the last&nbsp; background read.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Temperature[dd]</td><td class="CDLDefinition"><p>Temperature in decidegrees (1 unit=0.1?celsius)</p></td></tr></table></div>
</div>

<a name="ltc2942_last_mW"></a><a name="Topic239"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_mW</div>
 <div id="NDPrototype239" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">signed</span> <span class="SHKeyword">short</span> ltc2942_last_mW(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the power used between two subsequent background reads in mW.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Power</td><td class="CDLDefinition"><p>Power in mW</p></td></tr></table></div>
</div>

<a name="ltc2942_last_mA"></a><a name="Topic240"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_mA</div>
 <div id="NDPrototype240" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">signed</span> <span class="SHKeyword">short</span> ltc2942_last_mA(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the power used between two subsequent background reads in mW.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Power</td><td class="CDLDefinition"><p>Power in mW</p></td></tr></table></div>
</div>

<a name="ltc2942_last_strstatus"></a><a name="Topic241"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_strstatus</div>
 <div id="NDPrototype241" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">char</span> *ltc2942_last_strstatus(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">void</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns a status string describing the battery mV, mA and mW.</p><p>Maximum string buffer length: &quot;V=-65535 mV; I=-65535 mA; P=-65535 mW&quot; or 38 bytes + 1 null. 42 bytes.</p><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Power</td><td class="CDLDefinition"><p>Power in mW</p></td></tr></table></div>
</div>

<a name="ltc2942_last_mWs"></a><a name="Topic325"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_last_mWs</div>
 <div id="NDPrototype325" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">signed</span> <span class="SHKeyword">short</span> ltc2942_last_mWs(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">idx</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the mW power estimated during the last battery read.</p><p>This is updated each time the battery status is read and thus offers a short term view of battery usage.</p><p>For a longer term view of battery usage, use ltc2942_get_longbatstat.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">idx<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>Index of the last battery power; 0 means oldest, LTC2942NUMLASTMW-1 means most recent.</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Power</td><td class="CDLDefinition"><p>Power in mW</p></td></tr></table></div>
</div>

<a name="ltc2942_get_numlongbatstat"></a><a name="Topic326"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_get_numlongbatstat</div>
 <div id="NDPrototype326" class="NDPrototype NoParameterForm"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> ltc2942_get_numlongbatstat()</div>
 <div class="CBody"><p>Returns how many long battery statistics are available.</p><p>The number is zero, when the system is initialised, up to LTC2942NUMLONGBATSTAT-1.</p><p>As the battery statistics are stored in an interrupt routine, there may be more battery statistics available that the value returned, but there can never be less.</p><div class="CHeading">Returns</div><p>Number of battery statistics available at the time of query</p></div>
</div>

<a name="ltc2942_get_longbatstat"></a><a name="Topic327"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_get_longbatstat</div>
 <div id="NDPrototype327" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> ltc2942_get_longbatstat(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td></td><td class="PName last">idx,</td></tr><tr><td class="first"></td><td class="PType">LTC2942_BATSTAT&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">batstat</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the long battery statistics specified by idx.</p><p>idx should be an index between 0 and ltc2942_get_numlongbatstat()-1.&nbsp; If ltc2942_get_numlongbatstat() returns 0 then no battery statistics is available and ltc2942_get_longbatstat should not be called.</p><p>As the battery statistics are stored in an interrupt routine in a circular buffer which overwrites the oldest entries, successive calls to ltc2942_get_longbatstat with incrementing indices may skip one battery statistics between two successive calls.&nbsp; Example: ltc2942_get_longbatstat(0) should return the oldest battery statistic, say at t=1000 seconds. ltc2942_get_longbatstat(1) should return the one after that, say at 1=1100 seconds if battery statistics are updated every 100s.&nbsp; However if the long battery statistics are updated between the two calls and the circular buffer is full then the oldest entry is dropped and ltc2942_get_longbatstat(1) will return the battery statistics at t=1200 seconds.</p><p>This is not deemed an issue as the battery statistics comprises a timestamp.</p><p>Note that idx is not checked to point to a valid battery entry.</p><p>Parameters idx				-	Index of the battery statistics to return batstat			-	Pointer to the _LTC2942_BATSTAT structure to receive the statistics Returns: -</p></div>
</div>

<a name="ltc2942_clear_longbatstat"></a><a name="Topic328"></a><div class="CTopic TFunction LC">
 <div class="CTitle">ltc2942_clear_longbatstat</div>
 <div id="NDPrototype328" class="NDPrototype NoParameterForm"><span class="SHKeyword">void</span> ltc2942_clear_longbatstat()</div>
 <div class="CBody"><p>Clear the stored long battery statistics</p><div class="CHeading">Returns</div><p>-</p></div>
</div>

<a name="_ltc2942_add_longbatstat"></a><a name="Topic329"></a><div class="CTopic TFunction LC last">
 <div class="CTitle">_ltc2942_add_longbatstat</div>
 <div id="NDPrototype329" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> _ltc2942_add_longbatstat(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">LTC2942_BATSTAT&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">batstat</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Adds an entry to the battery stat, erasing the oldest one if needed.</p><p>This function is used internally in interrupts, hence no ATOMIC_BLOCK is not needed.</p><div class="CHeading">Returns</div><p>-</p></div>
</div>

</body></html>