<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>sd_bit.c</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0 (Development Release 08-22-2015) -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="sd_bit"></a><a name="Topic71"></a><div class="CTopic TFile LC first">
 <div class="CTitle">sd_bit</div>
 <div class="CBody"><p>Internal SD bit-manipulation functions: CRC, bit extraction, etc.</p><p><b>Internal bit manipulation functions</b></p><ul><li><p>_sd_bit2val:						Returns the value made up by n bits from a specified startbit position from a bitstring.</p></li></ul><p><b>Internal CRC functions</b></p><ul><li><p>_sd_crc7command:					Part of the CRC7 computation.</p></li><li><p>_sd_crc7byte:						Part of the CRC7 computation.</p></li><li><p>_sd_crc7end:						Part of the CRC7 computation.</p></li></ul></div>
</div>

<a name="Functions"></a><a name="Topic72"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Functions</div>
</div>

<a name="_sd_bit2val"></a><a name="Topic73"></a><div class="CTopic TFunction LC">
 <div class="CTitle">_sd_bit2val</div>
 <div id="NDPrototype73" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">long</span> _sd_bit2val(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">data,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td></td><td class="PName last">startbit,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td></td><td class="PName last">n</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns the value made up by n bits from a specified startbit position from a bitstring.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">data<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>Pointer to a bitstring</p></td></tr><tr><td class="CDLEntry">startbit<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Starting bit. Bit 0 is the MSB of data[0], bit 7 is the LSB of data[0], bit 8 is the MSB of data[1], etc.&nbsp; The startbit becomes the MSB of the return value.</p></td></tr><tr><td class="CDLEntry">n<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Number of bits to read</p></td></tr></table><div class="CHeading">Returns</div><p>Value</p></div>
</div>

<a name="_sd_crc7command"></a><a name="Topic74"></a><div class="CTopic TFunction LC">
 <div class="CTitle">_sd_crc7command</div>
 <div id="NDPrototype74" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> _sd_crc7command(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">cmd,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">p1,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">p2,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">p3,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">p4</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Part of the CRC7 computation.&nbsp; Commands (at least cmd0 and cmd8) must be terminated by a crc.&nbsp; CRC is computed on the command (including bit 6 set) and 4 bytes parameters and additional 7 zero bits (augmentation).</p><p>The functions _sd_crc7command, _sd_crc7byte and _sd_crc7end are used to compute this checksum.</p><p>_sd_crc7command can directly be called with the same parameters as _sd_command???</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">cmd<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>command to send to card</p></td></tr><tr><td class="CDLEntry">p1-p4</td><td class="CDLDefinition"><p>parameters</p></td></tr></table></div>
</div>

<a name="_sd_crc7byte"></a><a name="Topic75"></a><div class="CTopic TFunction LC">
 <div class="CTitle">_sd_crc7byte</div>
 <div id="NDPrototype75" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> _sd_crc7byte(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">crc7,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">d</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Part of the CRC7 computation.&nbsp; Commands (at least cmd0 and cmd8) must be terminated by a crc.&nbsp; CRC is computed on the command (including bit 6 set) and 4 bytes parameters and additional 7 zero bits (augmentation).</p><p>The functions _sd_crc7command, _sd_crc7byte and _sd_crc7end are used to compute this checksum.</p><p>Call _sd_crc7byte to update the crc7 with each byte of the payload.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">crc7<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>Current CRC</p></td></tr><tr><td class="CDLEntry">d<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span></div></td><td class="CDLDefinition"><p>New byte of the payload</p></td></tr></table><p>Returns crc7		-	New CRC</p></div>
</div>

<a name="_sd_crc7end"></a><a name="Topic76"></a><div class="CTopic TFunction LC last">
 <div class="CTitle">_sd_crc7end</div>
 <div id="NDPrototype76" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span> _sd_crc7end(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PName last">crc7</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Part of the CRC7 computation.&nbsp; Commands (at least cmd0 and cmd8) must be terminated by a crc.&nbsp; CRC is computed on the command (including bit 6 set) and 4 bytes parameters and additional 7 zero bits (augmentation).</p><p>The functions _sd_crc7command, _sd_crc7byte and _sd_crc7end are used to compute this checksum.</p><p>Call sd_crc7end at the end to finalise the CRC with the augmentation.</p><p>This function shifts the CRC left by 1 and adds 1, so that the return value can be directly sent to the card.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">cmd</td><td class="CDLDefinition"><p>command to send to card</p></td></tr><tr><td class="CDLEntry">p1-p4</td><td class="CDLDefinition"><p>parameters</p></td></tr></table></div>
</div>

</body></html>